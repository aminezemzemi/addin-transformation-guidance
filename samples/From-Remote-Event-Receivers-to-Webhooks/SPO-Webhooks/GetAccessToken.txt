

using (var pnpContext = await _pnpContextFactory.CreateAsync(
    new Uri($"https://piasysdev.sharepoint.com/sites/AddInTransformationGuidanceSamples"),
    CancellationToken.None))
{
    var token = await pnpContext.AuthenticationProvider.GetAccessTokenAsync(
        new Uri("https://piasysdev.sharepoint.com"),
        new string[] { "https://piasysdev.sharepoint.com/.default" });
}